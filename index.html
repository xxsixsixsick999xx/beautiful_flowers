<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sakura ‚Ä¢ Midnight Bloom</title>
  <style>
    :root{
      --bg0:#020311; --bg1:#040622; --bg2:#0b0f3b;
      --pinkA:#ffd2e8; --pinkB:#ff9ecb; --pinkC:#ff5aa9;
      --gold:#ffd16a; --stem:#2f7b58; --leaf:#38a774;
      --text:#eef3ff;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{
      overflow:hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 70% 20%, rgba(118,140,255,.25), rgba(0,0,0,0) 55%),
        radial-gradient(900px 600px at 20% 30%, rgba(255,120,200,.12), rgba(0,0,0,0) 55%),
        linear-gradient(to bottom, var(--bg2), var(--bg0) 80%);
    }

    /* Layers */
    .layer{ position:fixed; inset:0; }
    canvas.layer{ display:block; } /* penting: cegah ‚Äúblank‚Äù di beberapa browser */
    #sky{ z-index:0; }
    #fx{ z-index:1; pointer-events:none; }
    #stage{ z-index:2; display:grid; place-items:end center; padding-bottom: clamp(24px, 7vh, 84px); pointer-events:none; }
    #ui{ z-index:3; position:fixed; inset:0; } /* JANGAN pointer-events:none biar tombol bisa di klik */

    .vignette{
      position:absolute; inset:-10%;
      background: radial-gradient(closest-side at 50% 55%, rgba(0,0,0,0) 55%, rgba(0,0,0,.55) 95%);
      mix-blend-mode:multiply; opacity:.95; pointer-events:none;
    }
    .aura{
      position:absolute; inset:0;
      background:
        radial-gradient(900px 500px at 50% 75%, rgba(255,140,210,.12), rgba(0,0,0,0) 60%),
        radial-gradient(1100px 600px at 60% 30%, rgba(110,150,255,.12), rgba(0,0,0,0) 60%);
      filter: blur(1px); opacity:.9; pointer-events:none;
    }
    .moon{
      position:absolute;
      right: clamp(26px, 6vw, 90px);
      top: clamp(20px, 6vh, 80px);
      width: clamp(120px, 16vw, 190px);
      aspect-ratio:1/1;
      border-radius:999px;
      background:
        radial-gradient(circle at 35% 35%, rgba(255,255,255,.9) 0%, rgba(255,245,210,.82) 38%, rgba(230,215,165,.78) 68%, rgba(190,175,120,.72) 100%);
      box-shadow: 0 0 40px rgba(255,245,210,.18), 0 0 140px rgba(255,245,210,.10);
      overflow:hidden;
      pointer-events:none;
    }
    .moon:before{
      content:""; position:absolute; inset:-20%;
      background:
        radial-gradient(circle at 55% 65%, rgba(0,0,0,.14), rgba(0,0,0,0) 60%),
        radial-gradient(circle at 70% 35%, rgba(0,0,0,.10), rgba(0,0,0,0) 50%),
        radial-gradient(circle at 35% 75%, rgba(0,0,0,.09), rgba(0,0,0,0) 55%);
      mix-blend-mode:multiply; filter: blur(1px); opacity:.95;
    }

    /* Start overlay (harus pasti keliatan) */
    .gate{
      position:fixed; inset:0;
      display:grid; place-items:center;
      background: linear-gradient(to bottom, rgba(0,0,0,.55), rgba(0,0,0,.85));
      backdrop-filter: blur(8px);
      z-index: 999; /* paling atas */
      transition: opacity .55s ease, visibility .55s ease, transform .55s ease;
    }
    .gate.hidden{ opacity:0; visibility:hidden; transform: translateY(10px); }

    .panel{
      width:min(720px, calc(100% - 28px));
      border-radius: 22px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 25px 90px rgba(0,0,0,.55);
      padding: 22px 18px;
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .panel:before{
      content:""; position:absolute; inset:-2px;
      background:
        radial-gradient(700px 200px at 10% 20%, rgba(255,140,210,.18), rgba(0,0,0,0) 55%),
        radial-gradient(600px 220px at 90% 30%, rgba(120,160,255,.18), rgba(0,0,0,0) 55%);
      filter: blur(6px); opacity:.9; pointer-events:none;
    }
    .panel h1{ position:relative; margin:0 0 10px; font-size: clamp(22px, 3.6vw, 34px); letter-spacing:.6px; }
    .panel p{ position:relative; margin:0 auto 16px; max-width: 56ch; opacity:.9; line-height:1.55; font-size: clamp(13px, 1.8vw, 16px); }
    .btn{
      position:relative;
      display:inline-flex; gap:10px; align-items:center; justify-content:center;
      padding: 12px 18px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: linear-gradient(135deg, rgba(255,255,255,.22), rgba(255,255,255,.08));
      color: var(--text);
      text-decoration:none;
      font-weight: 800;
      letter-spacing:.3px;
      box-shadow: 0 14px 40px rgba(255,120,200,.18);
      cursor:pointer;
      user-select:none;
      transition: transform .15s ease, filter .2s ease;
    }
    .btn:hover{ transform: translateY(-2px); filter: brightness(1.05); }
    .tiny{ position:relative; margin-top:10px; font-size:12px; opacity:.7; }

    /* Flower */
    .flowerWrap{ width:min(560px, 92vw); height:min(560px, 62vh); position:relative; }
    .stem{
      position:absolute; left:50%; bottom: 30px;
      width: 10px; height: 0px;
      transform: translateX(-50%) rotate(-2deg);
      transform-origin: bottom center;
      border-radius: 999px;
      background: linear-gradient(to top, #163a2c, var(--stem));
      box-shadow: 0 16px 30px rgba(0,0,0,.35);
      opacity:0;
    }
    .leaf{
      position:absolute; width: 100px; height: 42px;
      border-radius: 120px 120px 120px 12px;
      background: radial-gradient(circle at 28% 40%, rgba(120,255,190,.35), rgba(0,0,0,0) 55%),
                  radial-gradient(circle at 35% 35%, #69e0a8 0%, var(--leaf) 55%, #1b6a48 100%);
      box-shadow: 0 14px 26px rgba(0,0,0,.25);
      opacity:0;
    }
    .leaf.l1{ left: calc(50% - 132px); bottom: 165px; transform: rotate(-18deg) scale(.62); transform-origin: 15% 55%; }
    .leaf.l2{ left: calc(50% + 30px); bottom: 230px; transform: scaleX(-1) rotate(-12deg) scale(.62); transform-origin: 15% 55%; }

    .blossom{
      position:absolute; left:50%; bottom: 250px;
      width: 260px; height: 260px;
      transform: translateX(-50%) translateY(30px) scale(.12);
      transform-origin: 50% 62%;
      opacity:0;
      filter: drop-shadow(0 0 30px rgba(255,120,200,.25))
              drop-shadow(0 0 90px rgba(255,120,200,.08));
    }
    .petal{ transform-origin: 130px 150px; transform: rotate(var(--r)) scale(.22); opacity:0; }
    .petal path{ fill: url(#petalGrad); }
    .petal .edge{ fill: rgba(255,255,255,.10); mix-blend-mode: screen; }
    .center{ opacity:0; transform-origin: 130px 150px; transform: scale(.55); }

    /* Bloom animation */
    body.bloom .stem{ opacity:1; animation: stemGrow 2.1s cubic-bezier(.16,.88,.2,1) forwards; }
    body.bloom .leaf{ opacity:1; animation: leafIn 1.1s cubic-bezier(.16,.88,.2,1) forwards; animation-delay: .85s; }
    body.bloom .leaf.l2{ animation-delay: 1.0s; }
    body.bloom .blossom{ opacity:1; animation: blossomIn 2.25s cubic-bezier(.14,.92,.18,1) forwards; animation-delay: 1.12s; }
    body.bloom .petal{ animation: petalOpen 1.55s cubic-bezier(.15,.9,.2,1) forwards; animation-delay: calc(1.55s + var(--d)); }
    body.bloom .center{ animation: centerPop .95s cubic-bezier(.2,.9,.2,1) forwards; animation-delay: 2.55s; }

    @keyframes stemGrow{ 0%{height:0} 65%{height:300px} 100%{height:330px} }
    @keyframes leafIn{ 0%{transform:translateY(10px) scale(.2) rotate(-18deg);opacity:0} 100%{transform:translateY(0) scale(.62) rotate(-18deg);opacity:1} }
    @keyframes blossomIn{ 0%{transform:translateX(-50%) translateY(52px) scale(.10);opacity:0} 70%{transform:translateX(-50%) translateY(6px) scale(.95);opacity:1} 100%{transform:translateX(-50%) translateY(0) scale(1);opacity:1} }
    @keyframes petalOpen{ 0%{transform:rotate(var(--r)) scale(.12);opacity:0} 55%{transform:rotate(var(--r)) scale(1.06);opacity:1} 100%{transform:rotate(var(--r)) scale(1);opacity:1} }
    @keyframes centerPop{ 0%{opacity:0;transform:scale(.45)} 60%{opacity:1;transform:scale(1.12)} 100%{opacity:1;transform:scale(1)} }

    .debug{
      position:fixed; right:12px; bottom:12px;
      font: 12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      padding:8px 10px;
      border-radius:12px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.12);
      opacity:.7;
      z-index: 1000;
      pointer-events:none;
    }
  </style>
</head>
<body>

  <canvas id="sky" class="layer"></canvas>
  <canvas id="fx" class="layer"></canvas>

  <div id="stage" class="layer" aria-hidden="true">
    <div class="flowerWrap">
      <div class="stem"></div>
      <div class="leaf l1"></div>
      <div class="leaf l2"></div>

      <svg class="blossom" viewBox="0 0 260 260">
        <defs>
          <radialGradient id="petalGrad" cx="32%" cy="28%" r="85%">
            <stop offset="0%" stop-color="var(--pinkA)"/>
            <stop offset="55%" stop-color="var(--pinkB)"/>
            <stop offset="100%" stop-color="var(--pinkC)"/>
          </radialGradient>
          <radialGradient id="centerGrad" cx="40%" cy="35%" r="70%">
            <stop offset="0%" stop-color="#fff4c6"/>
            <stop offset="55%" stop-color="var(--gold)"/>
            <stop offset="100%" stop-color="#ff9a2f"/>
          </radialGradient>
        </defs>

        <!-- 5 petals -->
        <g class="petal" style="--r:0deg;   --d:0s;">
          <path d="M130 44 C110 56, 86 84, 92 116 C97 142, 120 155, 130 170 C140 155, 163 142, 168 116 C174 84, 150 56, 130 44Z"/>
          <path class="edge" d="M130 54 C116 64, 96 88, 100 112 C103 130, 120 142, 130 156 C140 142, 157 130, 160 112 C164 88, 144 64, 130 54Z" opacity=".55"/>
        </g>
        <g class="petal" style="--r:72deg;  --d:.07s;">
          <path d="M130 44 C110 56, 86 84, 92 116 C97 142, 120 155, 130 170 C140 155, 163 142, 168 116 C174 84, 150 56, 130 44Z"/>
          <path class="edge" d="M130 54 C116 64, 96 88, 100 112 C103 130, 120 142, 130 156 C140 142, 157 130, 160 112 C164 88, 144 64, 130 54Z" opacity=".55"/>
        </g>
        <g class="petal" style="--r:144deg; --d:.14s;">
          <path d="M130 44 C110 56, 86 84, 92 116 C97 142, 120 155, 130 170 C140 155, 163 142, 168 116 C174 84, 150 56, 130 44Z"/>
          <path class="edge" d="M130 54 C116 64, 96 88, 100 112 C103 130, 120 142, 130 156 C140 142, 157 130, 160 112 C164 88, 144 64, 130 54Z" opacity=".55"/>
        </g>
        <g class="petal" style="--r:216deg; --d:.21s;">
          <path d="M130 44 C110 56, 86 84, 92 116 C97 142, 120 155, 130 170 C140 155, 163 142, 168 116 C174 84, 150 56, 130 44Z"/>
          <path class="edge" d="M130 54 C116 64, 96 88, 100 112 C103 130, 120 142, 130 156 C140 142, 157 130, 160 112 C164 88, 144 64, 130 54Z" opacity=".55"/>
        </g>
        <g class="petal" style="--r:288deg; --d:.28s;">
          <path d="M130 44 C110 56, 86 84, 92 116 C97 142, 120 155, 130 170 C140 155, 163 142, 168 116 C174 84, 150 56, 130 44Z"/>
          <path class="edge" d="M130 54 C116 64, 96 88, 100 112 C103 130, 120 142, 130 156 C140 142, 157 130, 160 112 C164 88, 144 64, 130 54Z" opacity=".55"/>
        </g>

        <g class="center">
          <circle cx="130" cy="150" r="20" fill="url(#centerGrad)"/>
          <g opacity=".75">
            <circle cx="120" cy="143" r="2.1" fill="#5a2b00"/>
            <circle cx="140" cy="142" r="2.1" fill="#5a2b00"/>
            <circle cx="132" cy="160" r="2.1" fill="#5a2b00"/>
            <circle cx="116" cy="159" r="1.9" fill="#5a2b00"/>
            <circle cx="146" cy="159" r="1.9" fill="#5a2b00"/>
          </g>
        </g>
      </svg>
    </div>
  </div>

  <div id="ui" class="layer" aria-hidden="true">
    <div class="moon"></div>
    <div class="aura"></div>
    <div class="vignette"></div>
  </div>

  <!-- START OVERLAY (selalu muncul) -->
  <div class="gate" id="gate">
    <div class="panel">
      <h1>üåô Sakura ‚Ä¢ Midnight Bloom</h1>
      <p>Klik tombol di bawah untuk mulai. Kalau ini muncul berarti HTML-mu kebaca normal.</p>
      <a class="btn" href="#" id="start">Mulai Bloom ‚ú®</a>
      <div class="tiny">Kalau tetap blank: pastikan nama file <b>index.html</b> dan Pages = main / root.</div>
    </div>
  </div>

  <div class="debug" id="debug">loading‚Ä¶</div>

  <script>
    // ===== debug helper (biar kamu tahu JS jalan) =====
    const dbg = document.getElementById('debug');
    const log = (t)=> dbg.textContent = t;

    // ===== helpers =====
    const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
    const rand=(a,b)=>Math.random()*(b-a)+a;
    const randi=(a,b)=>Math.floor(rand(a,b+1));

    // ===== canvas =====
    const sky = document.getElementById('sky');
    const fx  = document.getElementById('fx');
    const sctx = sky.getContext('2d');
    const fctx = fx.getContext('2d');

    let W=0,H=0,DPR=1;
    let stars=[], haze=[], shooting=null;
    let petals=[], motes=[], fireflies=[];
    let mouseX=0, mouseY=0;
    let blooming=false;

    window.addEventListener('mousemove', (e)=>{
      mouseX = (e.clientX / W - .5) || 0;
      mouseY = (e.clientY / H - .5) || 0;
    });

    function resize(){
      DPR = Math.min(2, window.devicePixelRatio || 1);
      W = window.innerWidth; H = window.innerHeight;

      sky.width = Math.floor(W*DPR); sky.height = Math.floor(H*DPR);
      fx.width  = Math.floor(W*DPR); fx.height  = Math.floor(H*DPR);
      sky.style.width = W+'px'; sky.style.height = H+'px';
      fx.style.width  = W+'px'; fx.style.height  = H+'px';

      sctx.setTransform(DPR,0,0,DPR,0,0);
      fctx.setTransform(DPR,0,0,DPR,0,0);

      buildSky();
      resetFX();
      log('ready ‚úì (klik "Mulai Bloom")');
    }
    window.addEventListener('resize', resize);

    function buildSky(){
      stars=[];
      const n = Math.floor((W*H)/9000);
      for(let i=0;i<n;i++){
        stars.push({
          x: Math.random()*W, y: Math.random()*H,
          r: Math.random()<.08 ? rand(1.2,2.2) : rand(.6,1.4),
          a: rand(.25, .9), t: rand(1.8, 5.5), p: rand(0, Math.PI*2),
          depth: rand(.3, 1.2)
        });
      }
      haze=[];
      for(let i=0;i<9;i++){
        haze.push({
          x: rand(-.1,.1)*W + rand(0,W),
          y: rand(0,H*0.9),
          r: rand(180, 420),
          a: rand(.05,.14),
          hue: Math.random()<.5 ? rand(210,250) : rand(310,350),
          depth: rand(.2, .9)
        });
      }
    }

    function resetFX(){
      petals=[]; motes=[]; fireflies=[];
      const m = Math.floor((W*H)/22000);
      for(let i=0;i<m;i++){
        motes.push({ x:rand(0,W), y:rand(0,H), r:rand(.6,1.6), a:rand(.05,.16),
          vx:rand(-.08,.08), vy:rand(-.06,.06), p:rand(0,Math.PI*2) });
      }
      const ff = clamp(Math.floor(W/120), 5, 10);
      for(let i=0;i<ff;i++){
        fireflies.push({
          x: rand(0,W), y: rand(H*0.45,H*0.92),
          vx: rand(-.25,.25), vy: rand(-.18,.18),
          phase: rand(0,Math.PI*2), speed: rand(.6,1.2), glow: rand(.35,.85)
        });
      }
    }

    function drawSky(t){
      const g = sctx.createLinearGradient(0,0,0,H);
      g.addColorStop(0, '#0b0f3b');
      g.addColorStop(.6,'#040622');
      g.addColorStop(1, '#020311');
      sctx.fillStyle=g; sctx.fillRect(0,0,W,H);

      for(const h of haze){
        const px = h.x + mouseX*30*h.depth;
        const py = h.y + mouseY*22*h.depth;
        const rg = sctx.createRadialGradient(px,py,0,px,py,h.r);
        rg.addColorStop(0, `hsla(${h.hue}, 90%, 70%, ${h.a})`);
        rg.addColorStop(1, `hsla(${h.hue}, 90%, 70%, 0)`);
        sctx.fillStyle = rg;
        sctx.fillRect(px-h.r, py-h.r, h.r*2, h.r*2);
      }

      for(const s of stars){
        const tw = (Math.sin(t*0.001*(2*Math.PI)/s.t + s.p)+1)/2;
        const a = s.a*(0.55 + 0.75*tw);
        const x = s.x + mouseX*40*s.depth;
        const y = s.y + mouseY*28*s.depth;
        sctx.globalAlpha = a;
        sctx.beginPath(); sctx.arc(x,y,s.r,0,Math.PI*2);
        sctx.fillStyle='white'; sctx.fill();
        if(s.r>1.6){
          sctx.globalAlpha = a*0.22;
          sctx.beginPath(); sctx.arc(x,y,s.r*6,0,Math.PI*2); sctx.fill();
        }
      }
      sctx.globalAlpha=1;

      if(!shooting && Math.random()<0.003){
        shooting = { x:rand(0,W*0.7), y:rand(0,H*0.35), vx:rand(10,16), vy:rand(4,7), life:0, max:randi(25,45) };
      }
      if(shooting){
        const sh = shooting; sh.life++;
        const x = sh.x + sh.vx*sh.life;
        const y = sh.y + sh.vy*sh.life;
        sctx.globalAlpha = clamp(1 - sh.life/sh.max, 0, 1);
        const gx = x - sh.vx*8, gy = y - sh.vy*8;
        const grad = sctx.createLinearGradient(x,y,gx,gy);
        grad.addColorStop(0,'rgba(255,255,255,.95)');
        grad.addColorStop(1,'rgba(255,255,255,0)');
        sctx.strokeStyle=grad; sctx.lineWidth=2;
        sctx.beginPath(); sctx.moveTo(x,y); sctx.lineTo(x - sh.vx*9, y - sh.vy*9); sctx.stroke();
        sctx.globalAlpha=1;
        if(sh.life>sh.max) shooting=null;
      }
    }

    function spawnPetal(){
      const originX = W*0.5 + rand(-60,60);
      const originY = H*0.55 + rand(-140,-40);
      petals.push({
        x:originX, y:originY,
        vx:rand(-0.35,0.35), vy:rand(0.2,0.65),
        rot:rand(0,Math.PI*2), vr:rand(-0.02,0.02),
        w:rand(10,16), h:rand(7,12),
        a:rand(.35,.85), life:0, max:randi(240,420)
      });
    }

    function drawPetal(p){
      fctx.save();
      fctx.translate(p.x,p.y);
      fctx.rotate(p.rot);

      const g = fctx.createRadialGradient(-p.w*0.2, -p.h*0.2, 0, 0, 0, p.w*1.2);
      g.addColorStop(0, `rgba(255,210,232,${p.a})`);
      g.addColorStop(.55, `rgba(255,158,203,${p.a})`);
      g.addColorStop(1, `rgba(255,90,169,${p.a*0.9})`);

      fctx.fillStyle=g;
      fctx.beginPath();
      fctx.moveTo(0, -p.h*0.9);
      fctx.bezierCurveTo(p.w*0.9, -p.h*0.7, p.w*0.95, p.h*0.4, 0, p.h*0.95);
      fctx.bezierCurveTo(-p.w*0.95, p.h*0.4, -p.w*0.9, -p.h*0.7, 0, -p.h*0.9);
      fctx.fill();

      fctx.restore();
    }

    function drawFX(t){
      fctx.clearRect(0,0,W,H);

      for(const m of motes){
        m.p += 0.01;
        m.x += m.vx + Math.cos(m.p)*0.04;
        m.y += m.vy + Math.sin(m.p)*0.03;
        if(m.x< -10) m.x=W+10; if(m.x> W+10) m.x=-10;
        if(m.y< -10) m.y=H+10; if(m.y> H+10) m.y=-10;
        fctx.globalAlpha = m.a;
        fctx.beginPath(); fctx.arc(m.x,m.y,m.r,0,Math.PI*2);
        fctx.fillStyle='white'; fctx.fill();
      }
      fctx.globalAlpha=1;

      if(blooming){
        if(Math.random()<0.22) spawnPetal();
        for(let i=petals.length-1;i>=0;i--){
          const p=petals[i];
          p.life++;
          const wind = Math.sin((t*0.001)+p.life*0.03)*0.12 + mouseX*0.35;
          p.x += p.vx + wind;
          p.y += p.vy + 0.12;
          p.rot += p.vr + wind*0.02;

          const fade = 1 - p.life/p.max;
          const alpha = p.a * clamp(fade*1.2, 0, 1);
          if(alpha<=0 || p.y>H+30 || p.x<-60 || p.x>W+60){ petals.splice(i,1); continue; }

          fctx.globalAlpha = alpha;
          drawPetal(p);
          fctx.globalAlpha = 1;
        }

        for(const f of fireflies){
          f.phase += 0.02 * f.speed;
          f.x += f.vx + Math.sin(f.phase)*0.35;
          f.y += f.vy + Math.cos(f.phase*0.9)*0.25;

          const tx = W*0.5 + Math.sin(f.phase*0.5)*W*0.12;
          const ty = H*0.70 + Math.cos(f.phase*0.6)*H*0.10;
          f.x += (tx - f.x)*0.004;
          f.y += (ty - f.y)*0.004;

          if(f.x<0) f.x+=W; if(f.x>W) f.x-=W;
          f.y = clamp(f.y, H*0.35, H*0.95);

          const blink=(Math.sin(f.phase*1.8)+1)/2;
          const a=(0.15+0.85*blink)*f.glow;

          fctx.globalAlpha=a;
          const r=2.2+blink*2.2;
          const grad=fctx.createRadialGradient(f.x,f.y,0,f.x,f.y,r*9);
          grad.addColorStop(0,`rgba(255,235,160,${a})`);
          grad.addColorStop(0.25,`rgba(255,235,160,${a*0.35})`);
          grad.addColorStop(1,'rgba(255,235,160,0)');
          fctx.fillStyle=grad;
          fctx.beginPath(); fctx.arc(f.x,f.y,r*9,0,Math.PI*2); fctx.fill();
          fctx.fillStyle=`rgba(255,245,190,${a})`;
          fctx.beginPath(); fctx.arc(f.x,f.y,r,0,Math.PI*2); fctx.fill();
          fctx.globalAlpha=1;
        }
      }
    }

    function loop(t){
      drawSky(t);
      drawFX(t);
      requestAnimationFrame(loop);
    }

    // ===== start / replay =====
    const gate = document.getElementById('gate');
    const startBtn = document.getElementById('start');

    function startBloom(){
      blooming = true;
      document.body.classList.add('bloom');
      gate.classList.add('hidden');
      log('blooming ‚úì (tekan Space untuk replay)');
    }
    function replay(){
      document.body.classList.remove('bloom');
      void document.body.offsetHeight;
      document.body.classList.add('bloom');
      petals.length=0;
      blooming=true;
      log('replay ‚úì');
    }

    startBtn.addEventListener('click', (e)=>{ e.preventDefault(); startBloom(); });
    window.addEventListener('keydown', (e)=>{
      if(e.code==='Space'){ e.preventDefault(); blooming ? replay() : startBloom(); }
    });

    // init
    resize();
    requestAnimationFrame(loop);
  </script>

</body>
</html>
